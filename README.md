# â˜ NINE Cloud
![main_image](https://github.com/Lee-chan0/nomyproject/assets/147553654/7d067198-cbd1-4824-abca-4de724fd2d07)
## âœğŸ» ì„œë¹„ìŠ¤ ì†Œê°œ
NINE CloudëŠ” ë§¤ì¼ í•˜ë‚˜ì˜ ì¼ê¸°ë¥¼ ì‘ì„±í•˜ë©° ìì‹ ì˜ ê°ì •ì„ ë˜ëŒì•„ë³´ê³  AI ì†”ë£¨ì…˜ì„ ë°›ëŠ” ê°ì •ì¼ê¸° ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.
## 
## ğŸŒí”„ë¡œì íŠ¸ ì†Œê°œ
<strong>[Front-End]</strong> : CRUD, AIì ‘ëª©, Socketì„ ì´ìš©í•œ ì±„íŒ…ê¸°ëŠ¥, ë¬´í•œìŠ¤í¬ë¡¤, canvasì‚¬ìš©, OAuthêµ¬í˜„

<strong>[Back-End]</strong> : CRUD, OAuthë¡œê·¸ì¸, Socketì„ í™œìš©í•œ ì±„íŒ…ê¸°ëŠ¥, S3ë¥¼ í™œìš©í•œ ì´ë¯¸ì§€ ì—…ë¡œë“œ, ìë™í™”ë°°í¬ CI/CDì— Docker, Nginxë¥¼ ì¶”ê°€í•´ ë¬´ì¤‘ë‹¨ë°°í¬ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•


<strong>[USER]</strong> : ë°”ì˜ê²Œ ì‚´ì•„ê°€ëŠ” í˜„ëŒ€ì¸ë“¤ì„ ìœ„í•´, ìì‹ ì˜ í•˜ë£¨ ê°ì •ì„ ë‚ ì”¨ì™€ ì—°ê´€ ì§€ì–´ ëŒì•„ë³¼ ìˆ˜ ìˆëŠ” ë‹¤ì´ì–´ë¦¬
##

## ğŸ“‚ Project GitHub
<strong>[Front-End]</strong> : https://github.com/final-project-hh99/front.git<br>
<strong>[Back-End]</strong> : https://github.com/Lee-chan0/final_project_back
## 

## â›…ï¸ íŒ€ì› ì†Œê°œ (ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦êµ¬ë¥´ë¯¸ë“¤)

- **Back End**
  - ìœ ì¬í˜„(ë¶€ë¦¬ë”)([https://github.com/yjhorion](https://github.com/yjhorion))
    1. Mainë‹¬ë ¥
    2. feedìƒì„±
    3. multer-S3 ì´ë¯¸ì§€ ì—…ë¡œë“œ
    4. socket.io ì±„íŒ…ê¸°ëŠ¥
  - ì´ì°¬ì˜([https://github.com/Lee-chan0](https://github.com/Lee-chan0))
    1. SignIn, SignUp
    2. OAuth
    3. CI/CD, ì¸í”„ë¼
    4. DevOps
- **Front End**
  - ì£¼ì² ë¯¼(ë¦¬ë”)([https://github.com/cheolminJOO](https://github.com/cheolminJOO))
    1. Mainë‹¬ë ¥
    2. ìƒì„¸í˜ì´ì§€
    3. ë§ˆì´í˜ì´ì§€
  - ì†¡ì§€ìš°([https://github.com/nsong113](https://github.com/nsong113))
    1. postí˜ì´ì§€
    2. GPT(AI)
    3. Communityí˜ì´ì§€
  - í•œë•ìš©([https://github.com/HyperQuanx](https://github.com/HyperQuanx))
    1. OAuth
    2. Sign In/Up
    3. WebSocket
- **Designer**
  - ì´ìŠ¹ì—°([20211009@sungshin.ac.kr](20211009@sungshin.ac.kr))

## â„ï¸ Project Architecture

![Untitled Diagram drawio (3)](https://github.com/Lee-chan0/nomyproject/assets/147553654/40f530a0-16cd-4abd-9c66-c57508d5c5d4)


## Stacks

<div align="center">
  <h1>ğŸ›  Tech Stack</h1>
  <p>
    <img src="https://img.shields.io/badge/javascript-F0DB4F?style=for-the-badge&logo=javascript&logoColor=black">
    <img src="https://img.shields.io/badge/node.js-68A063?style=for-the-badge&logo=Node.js&logoColor=white">
    <img src="https://img.shields.io/badge/express-FF6C37?style=for-the-badge&logo=express&logoColor=white">
  </p>
</div>

<div align="center">
  <h1>ğŸ—„ï¸ DB / ORM</h1>
  <p>
    <img src="https://img.shields.io/badge/mysql-00758F?style=for-the-badge&logo=mysql&logoColor=white">
    <img src="https://img.shields.io/badge/mongoDB-12924F?style=for-the-badge&logo=MongoDB&logoColor=white">
    <img src="https://img.shields.io/badge/AWS%20RDS-527FFF?style=for-the-badge&logo=amazonrds&logoColor=white">
    <img src="https://img.shields.io/badge/Redis-C92B2B?style=for-the-badge&logo=redis&logoColor=white">
    <img src="https://img.shields.io/badge/Prisma-2A7AE4?style=for-the-badge&logo=Prisma&logoColor=white">
  </p>
</div>

<div align="center">
  <h1>ğŸ–¥ï¸ CI/CD & DevOps</h1>
  <p>
    <img src="https://img.shields.io/badge/github-6E5494?style=for-the-badge&logo=github&logoColor=white">
    <img src="https://img.shields.io/badge/GitHub%20Actions-2088FF?style=for-the-badge&logo=githubactions&logoColor=white">
    <img src="https://img.shields.io/badge/AWS%20EC2-FF9900?style=for-the-badge&logo=amazonec2&logoColor=white">
    <img src="https://img.shields.io/badge/AWS%20S3-569A31?style=for-the-badge&logo=amazons3&logoColor=white">
    <img src="https://img.shields.io/badge/AWS%20CodeDeploy-FF7F00?style=for-the-badge&logo=aws&logoColor=white">
    <img src="https://img.shields.io/badge/Docker%20Compose-DA70D6?style=for-the-badge&logo=docker&logoColor=white">
    <img src="https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white">
    <img src="https://img.shields.io/badge/Nginx-009639?style=for-the-badge&logo=nginx&logoColor=white">
  </p>
</div>

<div align="center">
  <h1>ğŸ“œ Library & Monitoring & Communication</h1>
  <p>
    <img src="https://img.shields.io/badge/socket.io-FF4081?style=for-the-badge&logo=socket.io&logoColor=white">
    <img src="https://img.shields.io/badge/JWT-00B2A9?style=for-the-badge&logo=jsonwebtokens&logoColor=white">
    <img src="https://img.shields.io/badge/Swagger-E3E569?style=for-the-badge&logo=swagger&logoColor=white">
    <img src="https://img.shields.io/badge/Grafana-F46800?style=for-the-badge&logo=grafana&logoColor=white">
    <img src="https://img.shields.io/badge/Jest-C21325?style=for-the-badge&logo=jest&logoColor=white">
    <img src="https://img.shields.io/badge/Notion-8B8B8B?style=for-the-badge&logo=notion&logoColor=white">
    <img src="https://img.shields.io/badge/Slack-E01E5A?style=for-the-badge&logo=slack&logoColor=white">
  </p>
  <br>
</div>

## ğŸ“œ Library

|      Library       |                                 Description                                  |
|:------------------:|:----------------------------------------------------------------------------:|
|      dotenv       |        í™˜ê²½ ë³€ìˆ˜ë¥¼ ê´€ë¦¬í•˜ì—¬ ë³´ì•ˆì ìœ¼ë¡œ ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ì•ˆì „í•˜ê²Œ ìˆ¨ê¹€         |
|       cors        |           ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ Cross-Origin Resource Sharing í•´ê²°               |
|      bcrypt       |          ë¹„ë°€ë²ˆí˜¸ì™€ ê°™ì€ ë°ì´í„°ë¥¼ ì•ˆì „í•˜ê²Œ í•´ì‹œí•˜ì—¬ ì €ì¥í•˜ê¸° ìœ„í•¨           |
|        joi        |                      ìš”ì²­ ë°ì´í„°ì˜ ìœ íš¨ì„± ê²€ì¦ì„ ìœ„í•¨                        |
|    nodemailer     |           ì´ë©”ì¼ ì „ì†¡ ê¸°ëŠ¥ì„ ìœ„í•œ Node.js ê¸°ë°˜ì˜ ë©”ì¼ ì „ì†¡ ë¼ì´ë¸ŒëŸ¬ë¦¬          |
|      express      |      ë¹ ë¥´ê³  ìœ ì—°í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì„ ìœ„í•œ Node.js ì›¹ í”„ë ˆì„ì›Œí¬        |
|   jsonwebtoken    |        ì‚¬ìš©ì ì¸ì¦ê³¼ ì •ë³´ ì „ì†¡ì„ ìœ„í•œ JSON ê¸°ë°˜ì˜ Web Token ìƒì„±            |
|     date-fns      |          ë‚ ì§œì™€ ì‹œê°„ì„ ë‹¤ë£¨ê¸° ìœ„í•œ í¬ê´„ì ì´ê³  ì‹ ë¢°ì„± ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬         |
|   date-fns-tz     |               ì‹œê°„ëŒ€ë¥¼ ê³ ë ¤í•œ ë‚ ì§œ ë° ì‹œê°„ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬             |
|     ioredis       |         Node.jsì—ì„œ Redis ë°ì´í„°ë² ì´ìŠ¤ì™€ í†µì‹ í•˜ê¸° ìœ„í•œ íš¨ìœ¨ì ì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬     |
|      multer       |               íŒŒì¼ ì—…ë¡œë“œë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ Node.js ë¯¸ë“¤ì›¨ì–´                  |
|    socket.io      |             ì‹¤ì‹œê°„, ì–‘ë°©í–¥ í†µì‹ ì„ ìœ„í•œ Node.js ê¸°ë°˜ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬            |
|     node-cron     |        ì •í•´ì§„ ì¼ì •ì— ë”°ë¼ ì‘ì—…ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•œ Node.js ê¸°ë°˜ ìŠ¤ì¼€ì¤„ëŸ¬         |
|     multer-s3     |             AWS S3ì™€ í†µí•©í•˜ì—¬ íŒŒì¼ ì—…ë¡œë“œë¥¼ ì²˜ë¦¬í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬              |


## ğŸ” API

[Notion API Address](https://www.notion.so/API-22f9456b7c254576b2a9cbc101c603d1)

![ìº¡ì²˜2](https://github.com/Lee-chan0/nomyproject/assets/147553654/b42a681c-1e56-4a08-94de-b601727e39a3)
![ìº¡ì²˜3](https://github.com/Lee-chan0/nomyproject/assets/147553654/980c3de8-3e8f-46b9-bd2c-2e5a0aedf415)
![ìº¡ì²˜4](https://github.com/Lee-chan0/nomyproject/assets/147553654/3ff9b052-0a8b-401c-b714-823ab3920227)

## ğŸ“‹ ERD

![drawSQL-finalproject-export-2023-12-21](https://github.com/Lee-chan0/nomyproject/assets/147553654/882e770c-f5b9-4b0b-8053-a73578bc256d)

## ğŸ’£ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
<details>
<summary>multerS3ë¥¼ ì‚¬ìš©í•œ ì´ë¯¸ì§€ ì—…ë¡œë“œ</summary>
â— ë¬¸ì œ ìƒí™© : multerS3ë¡œ bucketì— Image uploadthis.client.send is not a function ì—ëŸ¬ê°€ ë°œìƒ<br>
â— ê¸°ì¡´ ì„¤ì •ì˜ ë¬¸ì œì <br>
  - ì½”ë“œìƒì˜ ë¬¸ì œë¥¼ ì˜ì‹¬í–ˆìœ¼ë‚˜, ì½”ë“œìƒì—” ë¬¸ì œê°€ ì—†ëŠ”ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.<br>
  - ì´í›„ multer-s3ì™€ aws-sdkëª¨ë“ˆì´ ì„œë¡œ í˜¸í™˜ë˜ëŠ” ë²„ì „ì´ì–´ì•¼ í•œë‹¤ëŠ”ê²ƒì„ ì•Œê²ŒëìŠµë‹ˆë‹¤.
âœ… ë²„ì „ ì—…ë°ì´íŠ¸
  - npmì„ ì‚¬ìš©í•˜ì—¬, ì„œë¡œ í˜¸í™˜ë˜ëŠ” ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•´ì¤Œìœ¼ë¡œì¨ í•´ê²°í–ˆìŠµë‹ˆë‹¤.
  
```javascript
// package.json
...
"aws-sdk" : "^2.1520.0",
"multer-s3" : "^3.0.1",
...
```
</details>

<details>
<summary>socket.ioì™€ mongoDB ì—°ê²° ì´ìŠˆ</summary>
â— ë¬¸ì œìƒí™© : socketì„ ê¸°ì¡´ DBê°€ ì•„ë‹Œ, mongoDBì— ë”°ë¡œ ì—°ê²°í•˜ì—¬ ì‚¬ìš©í•˜ë ¤ í• ë•Œ, timeoutì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ì„œ ì±„íŒ…ì´ ì—°ê²°ë˜ì§€ì•Šì€ í˜„ìƒë°œìƒ<br>
â— ë¬¸ì œ í•´ê²° ì ‘ê·¼<br>
- localí™˜ê²½ì—ì„œ .envì˜ ê°’ê³¼ mongoDBìì²´ì˜ connectionì—ëŸ¬ê°€ ì—†ëŠ”ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. <br>
- app.js(ì„œë²„ ì‹¤í–‰ íŒŒì¼)ì—ì„œ mongoDBê°€ ì—°ê²°ë˜ê¸° ì´ì „ì— routerì—ì„œ ì ‘ê·¼ì´ ì´ë£¨ì–´ì§€ëŠ”ì§€ë„ í™•ì¸í–ˆìœ¼ë‚˜ ë¬¸ì œê°€ ì—†ì—ˆìŠµë‹ˆë‹¤. <br>
- GitActionsì—ëŠ” ì •ìƒì ìœ¼ë¡œ secretsë³€ìˆ˜ê°€ .envíŒŒì¼ì— í• ë‹¹ë˜ëŠ”ê²ƒì„ í™•ì¸í–ˆì§€ë§Œ, ìë™í™” ë°°í¬ë„ì¤‘ docker-composeë¥¼ ì‚¬ìš©í•œ ë¹Œë“œê³¼ì •ì—ì„œ .envíŒŒì¼ì´ ì—…ë°ì´íŠ¸ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. <br>
- ë°°í¬ê°€ ë˜ëŠ” ec2ì„œë²„ì— .envíŒŒì¼ì„ í™•ì¸í•´ë³´ë‹ˆ, ì •ìƒì ìœ¼ë¡œ .envíŒŒì¼ì— mongoDB ì—°ê²°ì— í•„ìš”í•œ ë³€ìˆ˜ê°€ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠëŠ”ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.<br>
  
âœ… ë¬¸ì œí•´ê²°<br>
- docker-composeë¥¼ í†µí•´ ë¹Œë“œë˜ëŠ” ê³¼ì •ì—ì„œ stringìœ¼ë¡œ ì´ë£¨ì–´ì§„ í™˜ê²½ë³€ìˆ˜ëŠ” â€œâ€ë¡œ ê°ì‹¸ì£¼ì§€ ì•Šìœ¼ë©´ .envíŒŒì¼ì— ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠëŠ”ê²ƒì„ í™•ì¸í–ˆê³ , ë¬¸ìì—´ ì²˜ë¦¬ë¥¼ í•´ì£¼ì ì •ìƒì ìœ¼ë¡œ .envíŒŒì¼ì— ì—…ë°ì´íŠ¸ ë˜ì—ˆìŠµë‹ˆë‹¤.


</details>

<details>
<summary>EC2 ì¸ìŠ¤í„´ìŠ¤ í™˜ê²½ì—ì„œì˜ Dockerê¶Œí•œ ì´ìŠˆ</summary>
â—ë¬¸ì œ ìƒí™© : dockerë¥¼ ì‚¬ìš©í–ˆì„ë•Œ, connect: permission denied ê°€ ìƒê²¨ docker ì‚¬ìš© ë¶ˆê°€<br>
âœ… ë¬¸ì œ í•´ê²° ì ‘ê·¼<br>
1. ì—ëŸ¬ì›ì¸ ë¶„ì„ : í•´ë‹¹ error messageë¥¼ êµ¬ê¸€ë§í•˜ì—¬ ë¹„ìŠ·í•œ ì‚¬ë¡€ë¥¼ ì°¾ì•„ë³´ë‹ˆ, dockerê°€ groupì— ì†í•´ìˆì§€ ì•Šê¸°ë•Œë¬¸ì„ì„ ì•Œê²ŒëìŠµë‹ˆë‹¤.<br>
2. í•´ê²° ë°©ë²• : docker gruopì´ ì¶”ê°€ë˜ì§€ ì•Šì•˜ê³ , í•´ë‹¹ groupì— ë¡œê·¸ì¸ ì¤‘ì¸ ìœ ì €ê°€ ì¶”ê°€ë˜ì–´ ìˆì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì´ë¼ëŠ”ê²ƒì„ ì•Œê²Œë˜ì–´, <br>
  
```javascript
//ec2 ì¸ìŠ¤í„´ìŠ¤ í™˜ê²½(ubuntu)
sudo groupadd docker
sudo usermod -aG docker $USER
```
ì´í›„, exitëª…ë ¹ì–´ í˜¹ì€ newgrp docker ëª…ë ¹ì–´ë¡œ ì ìš©í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.<br>
</details>

<details>
<summary>Blue/Greenì „ëµ ë¬´ì¤‘ë‹¨ ë°°í¬ ì¤‘ ë‹¤ìš´íƒ€ì„ ì´ìŠˆ</summary>
â— ë¬¸ì œ ìƒí™© : â€˜ë¬´ì¤‘ë‹¨ ë°°í¬â€™ì´ì§€ë§Œ, ì„œë²„ê°€ í•­ìƒ ì ê¹ êº¼ì¡Œë‹¤ê°€ ì¼œì ¸ì„œ â€˜ë‹¤ìš´íƒ€ì„â€™ì´ ë°œìƒí•˜ì—¬, ë¬´ì¤‘ë‹¨ ë°°í¬ ì „ëµì— ì¹˜ëª…ì ì¸ ì—ëŸ¬ì˜€ìŠµë‹ˆë‹¤. (502 Bad Gateway)<br>
âœ… ì›ì¸ íŒŒì•… ë° í•´ê²° ë°©ë²• : ì„œë²„ì˜ (Nginx)502 Bad Gateway ë°œìƒ<br>
1. í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„

```javascript
// healthì²´í¬ ì—”ë“œí¬ì¸íŠ¸
app.get("/health", (req, res) => {
  const isServerOnline = true;

  const serverStartTime = new Date().toISOString();

  const cpuUsage = os.loadavg()[0]; 
  const totalMemory = os.totalmem();
  const freeMemory = os.freemem();
  const usedMemory = totalMemory - freeMemory;

  const diskInfo = os.cpus(); 
  

  const healthStatus = {
    serverStatus: isServerOnline ? "Online" : "Offline",
    serverStartTime: serverStartTime,
    cpuUsage: cpuUsage,
    memoryUsage: {
      total: totalMemory,
      used: usedMemory,
      free: freeMemory,
    },
    diskSpace: diskInfo,
  };
  if (isServerOnline) {
    res.status(200).json(healthStatus);
  } else {
    res.status(503).json({ serverStatus: "Offline" });
  }
});
```
í•´ë‹¹ ì—”ë“œí¬ì¸íŠ¸ë¡œ ì„œë²„ê°€ Onlineì¸ì§€, Offlineì¸ì§€ ì²´í¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. <br>

2. docker-compose.ymlíŒŒì¼ì— ìë™í™” í—¬ìŠ¤ì²´í¬ ì½”ë“œ ì¶”ê°€<br>

```javascript
  blue:
    build: .
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "https://astraiosissda.shop/health"]
      interval: 30s
      timeout: 10s
      retries: 5
```
30ì´ˆì— í•œë²ˆì”© ì„œë²„ì˜ í•´ë‹¹ ì—”ë“œí¬ì¸íŠ¸ì— ìš”ì²­ì„ ë³´ë‚´ì–´ í—¬ìŠ¤ì²´í¬ë¥¼ ì§„í–‰í•˜ê³ , 5ë²ˆì˜ ì¬ì‹œë„ë¥¼ í•©ë‹ˆë‹¤.<br>

3. dockerì‹¤í–‰íŒŒì¼ì¸, ./deployíŒŒì¼ ìˆ˜ì •<br>

```javascript
#!/bin/bash

CURRENT=$(docker ps --format '{{.Names}}' | grep -oE 'finalcicd_(blue|green)_1' | head -n 1 | cut -d'_' -f2)

echo "Current container: $CURRENT"

if [ "$CURRENT" == "blue" ]; then
    docker-compose up -d --build green

    echo "Green Container í—¬ìŠ¤ ì²´í¬"
    HEALTH_CHECK() {
        local retries=0
        until [ $retries -ge 3 ]; do
            if curl --connect-timeout 3 --max-time 3 -f https://astraiosissda.shop/health; then
                echo "Green Container í—¬ìŠ¤ ì²´í¬ ì„±ê³µ / íŠ¸ë˜í”½ ì „í™˜"
                return 0
            else
                retries=$((retries+1))
                echo "í—¬ìŠ¤ ì²´í¬ ì‹¤íŒ¨ 5ì´ˆë’¤ ë‹¤ì‹œ ì‹œë„"
                sleep 5
            fi
        done
        echo "í—¬ìŠ¤ ì²´í¬ ì‹¤íŒ¨ ê¸°ì¡´ ì»¨í…Œì´ë„ˆë¡œ ë¡¤ë°±"
        docker-compose stop green
        exit 1
    }

    HEALTH_CHECK

    sed -i 's/blue:3000/green:3000/' ./nginx.conf
    docker-compose restart nginx


    docker-compose stop blue

elif [ "$CURRENT" == "green" ]; then
    docker-compose up -d --build blue

    echo "Blue Container í—¬ìŠ¤ ì²´í¬"
    HEALTH_CHECK() {
        local retries=0
        until [ $retries -ge 3 ]; do
            if curl --connect-timeout 3 --max-time 3 -f https://astraiosissda.shop/health; then
                echo "Blue Container í—¬ìŠ¤ ì²´í¬ ì„±ê³µ / íŠ¸ë˜í”½ ì „í™˜"
                return 0
            else
                retries=$((retries+1))
                echo "í—¬ìŠ¤ ì²´í¬ ì‹¤íŒ¨ 5ì´ˆë’¤ ë‹¤ì‹œ ì‹œë„"
                sleep 5
            fi
        done
        echo "í—¬ìŠ¤ ì²´í¬ ì‹¤íŒ¨ ê¸°ì¡´ ì»¨í…Œì´ë„ˆë¡œ ë¡¤ë°±"
        docker-compose stop blue
        exit 1
    }

    HEALTH_CHECK

    sed -i 's/green:3000/blue:3000/' ./nginx.conf
    docker-compose restart nginx

    docker-compose stop green
fi
```
í•´ë‹¹ íŒŒì¼ë¡œ, í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ì»¨í…Œì´ë„ˆë¥¼ í™•ì¸í•˜ê³ , ìƒˆë¡­ê²Œ ë¹Œë“œí•œ ì»¨í…Œì´ë„ˆì˜ í—¬ìŠ¤ì²´í¬ë¥¼ ì§„í–‰í•œë’¤, í—¬ìŠ¤ì²´í¬ì— ì‹¤íŒ¨í–ˆë‹¤ë©´, ê¸°ì¡´ ì»¨í…Œì´ë„ˆë¡œ ë¡¤ë°±,<br> í—¬ìŠ¤ì²´í¬ì— ì„±ê³µí–ˆë‹¤ë©´, nginxë¥¼ í™œìš©í•´ íŠ¸ë˜í”½ì„ ì „í™˜í•˜ë©°, ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆë¥¼ upí•˜ê³  ê¸°ì¡´ ì»¨í…Œì´ë„ˆë¥¼ downì‹œí‚µë‹ˆë‹¤.<br>
âœ… ê²°ê³¼ : ì´í›„, ì„œë²„ê°€ ëŠê¹€ì—†ì´ ë²„ì „ì— ë”°ë¼ ë°°í¬ê°€ ì˜ ì§„í–‰ë˜ì—ˆê³ , ë‹¤ìš´íƒ€ì„í˜„ìƒì„ í•´ê²°í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
</details>
